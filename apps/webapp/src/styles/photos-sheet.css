.photos-sheet { padding: 12px; }
.empty { margin:16px 0; color:rgba(255,255,255,.5); }
.photo-grid { margin-top:12px; }
.grid { display:grid; grid-template-columns:repeat(4,minmax(0,1fr)); gap:8px; }

/* ряд с кнопками наверху шита */
.actions-row{
  position:relative; z-index:2;
  display:flex; align-items:center; gap:8px; flex-wrap:nowrap;
  padding:8px 12px;
  overflow-x:auto;
}
.actions-row::-webkit-scrollbar{ display:none; }
.actions-row .btn-soft{ flex-shrink:0; white-space:nowrap; }

/* мягкая кнопка — используется и для Add photo, и для Done */
.btn-soft{
  position:relative; z-index:1;
  display:inline-flex; align-items:center; gap:8px;
  padding:8px 12px;
  border-radius:12px;
  background:color-mix(in srgb, #ffffff 12%, transparent);
  border:1px solid color-mix(in srgb, #ffffff 35%, transparent);
  backdrop-filter:blur(6px);
  box-shadow:0 2px 12px rgba(0,0,0,.18);
  color:rgba(255,255,255,.92);
  font-weight:600;
  font-size:14px;
  line-height:1;
}
.btn-soft:hover{ background:color-mix(in srgb, #ffffff 18%, transparent); }
.btn-soft:active{ transform:translateY(1px); }
.btn-soft.is-disabled,
.btn-soft:disabled{
  opacity:.45;
  pointer-events:none;
}
.btn-soft.is-active{
  background: color-mix(in srgb, #ffffff 18%, transparent);
  border-color: color-mix(in srgb, #ffffff 45%, transparent);
}

/* компактные кнопки-иконки для миниатюр */
.btn-icon{
  display:inline-grid; place-items:center;
  width:26px;
  height:26px;
  border-radius:8px;
  border:1px solid rgba(255,255,255,.35);
  background:color-mix(in srgb, #ffffff 12%, transparent);
  color:#fff;
  backdrop-filter:blur(8px);
  box-shadow:0 2px 10px rgba(0,0,0,.25);
}
.btn-icon:hover{ background:color-mix(in srgb, #ffffff 18%, transparent); }
.btn-icon:disabled{ opacity:.45; box-shadow:none; }
.btn-icon svg{ width:14px; height:14px; }

/* блок «Add photo» */
.add-btn{ margin-left: 0; pointer-events:auto; }

/* миниатюры */
.thumb{ position:relative; border-radius:10px; overflow:hidden; min-height:72px; background:rgba(255,255,255,.03); }
.thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
.thumb.is-top{ outline:2px solid rgba(59,130,246,.75); }
.thumb.is-bottom{ outline:2px solid rgba(16,185,129,.75); }
.thumb.is-top.is-bottom{ outline:2px solid rgba(236,72,153,.75); }
.thumb.is-selected::after{
  content:"";
  position:absolute;
  inset:0;
  background:color-mix(in srgb, #ffffff 8%, transparent);
}


.thumb .ov-top-left,
.thumb .ov-top-right,
.thumb .ov-bot-right{
  position:absolute;
  display:flex;
  gap:6px;
  z-index:2;
}
.thumb .ov-top-left{ top:6px; left:6px; }
.thumb .ov-top-right{ top:6px; right:6px; z-index:3; }
.thumb .ov-bot-right{ bottom:6px; right:6px; }

.thumb .check{
  width:24px;
  height:24px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.5);
  background:rgba(0,0,0,.45);
  color:#fff;
  display:grid;
  place-items:center;
  backdrop-filter:blur(6px);
  transition:background .15s ease, border-color .15s ease;
}
.thumb .check svg{ width:14px; height:14px; }
.thumb .check.is-active{
  background:rgba(16,185,129,.85);
  border-color:rgba(255,255,255,.8);
}

/* быстрый кроп в превью слотов */
.slot-thumb .edit{
  position:absolute;
  top:6px;
  right:6px;
  width:26px;
  height:26px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.35);
  background:rgba(0,0,0,.45);
  color:#fff;
  display:grid;
  place-items:center;
  backdrop-filter:blur(4px);
}
.slot-thumb .edit svg{ width:14px; height:14px; }


/* Нумерация в кружке — тоже мягче */
.thumb .badge,
.slot-thumb .badge{
  position:absolute; top:6px; left:6px;
  display:grid; place-items:center;
  min-width:26px; height:26px; padding:0 6px; border-radius:999px;
  font-size:12px; font-weight:700;
  color:#fff;
  background:color-mix(in srgb, #000 45%, transparent);
  border:1px solid rgba(255,255,255,.25);
  backdrop-filter:blur(4px);
}
.thumb .badge{ top:auto; bottom:6px; opacity:1; }
.slot-thumb .badge{ top:6px; bottom:auto; }

.collage-slots{ display:flex; align-items:flex-start; gap:12px; margin-bottom:16px; }
.collage-slots .swap-btn{ align-self:center; display:inline-flex; align-items:center; gap:6px; }

.slot-thumb{ position:relative; display:flex; flex-direction:column; align-items:center; gap:6px; width:min(140px, 38vw); }
.slot-thumb.is-active .slot-thumb__button{ border-color:color-mix(in srgb, #ffffff 45%, transparent); box-shadow:0 0 0 1px rgba(255,255,255,.2); }
.slot-thumb.is-empty .slot-thumb__button{ border-style:dashed; border-color:rgba(255,255,255,.18); }
.slot-thumb__button{ position:relative; width:100%; border-radius:12px; overflow:hidden; border:1px solid rgba(255,255,255,.18); background:rgba(0,0,0,.22); cursor:pointer; padding:0; }
.slot-thumb__surface{ position:relative; width:100%; height:100%; }
.slot-thumb__image{ pointer-events:none; }
.slot-thumb__placeholder{ display:flex; align-items:center; justify-content:center; padding:12px; color:rgba(255,255,255,.65); font-weight:600; font-size:13px; text-align:center; min-height:48px; }
.slot-thumb__label{ font-size:13px; font-weight:600; color:rgba(255,255,255,.72); text-align:center; }

.collage-menu{ position:absolute; z-index:10; display:flex; flex-direction:column; background:rgba(20,20,24,.95); border:1px solid rgba(255,255,255,.14); border-radius:12px; padding:8px; gap:4px; min-width:160px; box-shadow:0 10px 30px rgba(0,0,0,.35); transform:translate(-50%, 0); }
.collage-menu button{ width:100%; padding:8px 10px; text-align:left; border:0; background:transparent; color:#fff; font-size:14px; border-radius:8px; }
.collage-menu button:hover{ background:rgba(255,255,255,.08); }
.collage-menu__close{ color:rgba(255,255,255,.75); text-align:center !important; }

@media (max-width: 640px){
  .grid{ grid-template-columns:repeat(3,minmax(0,1fr)); }
}



.crop-modal{ position:fixed; inset:0; z-index:120; display:flex; align-items:center; justify-content:center; }
.crop-modal__overlay{ position:absolute; inset:0; background:rgba(0,0,0,.65); }
.crop-modal__panel{ position:relative; z-index:121; width:min(92vw, 600px); max-height:90vh; background:rgba(15,15,18,.96); color:#fff; border-radius:18px; padding:20px; display:flex; flex-direction:column; gap:18px; box-shadow:0 20px 60px rgba(0,0,0,.45); }
.crop-modal__header{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
.crop-modal__header h3{ margin:0; font-size:18px; font-weight:600; }
.crop-modal__close{ border:0; background:transparent; color:#fff; font-size:26px; line-height:1; padding:0 4px; cursor:pointer; }
.crop-modal__content{ display:flex; flex-direction:column; gap:12px; }
.crop-modal__canvas{ position:relative; width:100%; height:min(60vh, 460px); background:#000; border-radius:16px; overflow:hidden; }
.crop-modal__surface{ position:absolute; top:50%; left:50%; transform-origin:top left; border-radius:12px; overflow:hidden; background:#000; box-shadow:0 12px 24px rgba(0,0,0,.35); touch-action:none; cursor:grab; }
.crop-modal__surface canvas{ width:100%; height:100%; display:block; }
.crop-modal__controls{ display:flex; gap:12px; }
.crop-modal__footer{ display:flex; justify-content:flex-end; gap:12px; }

